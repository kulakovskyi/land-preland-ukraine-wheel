"use strict";

var playBtn = document.querySelector('.bonus__main-wheel-btn'),
  main = document.querySelector('.bonus__main'),
  chips = document.querySelectorAll('.bonus__chip'),
  popupChips = document.querySelectorAll('.bonus__overlay-chip'),
  firstWoman = document.querySelector('.bonus__overlay-firstWoman'),
  secondWoman = document.querySelector('.bonus__overlay-secondWoman'),
  wheel = document.querySelector('.bonus__main-wheel-reel'),
  overlay = document.querySelector('.bonus__overlay'),
  popupFirst = document.querySelector('.bonus__firstWin'),
  popupFirstBtn = document.querySelector('.bonus__firstWin-btn'),
  popupSecond = document.querySelector('.bonus__secondWin'),
  overflow = document.querySelector('body'),
  video = document.querySelector('.bonus__main-video-bg'),
  wrapper = document.querySelector('.bonus');
var bonusText = document.querySelector('.bonus__main-bubble');
window.onload = videoSource(video, 'img/video.mp4', 'video/mp4');
function videoSource(element, src, type) {
  if (window.innerWidth > 1024) {
    var source = document.createElement('source');
    source.src = src;
    source.type = type;
    video.appendChild(source);
  }
}
var triesCounter = 0;
playBtn.addEventListener('click', function () {
  if (triesCounter === 0) {
    runFirstRotation();
  } else {
    runSecondRotation();
  }
});
function runFirstRotation() {
  wheel.classList.add('reel-rotation-first');
  playBtn.classList.remove('pulse-btn');
  playBtn.style.cursor = 'default';
  wrapper.style.pointerEvents = 'none';
  setTimeout(function () {
    doAfterFirstRotation();
  }, 6000);
  triesCounter++;
}
function doAfterFirstRotation() {
  wheel.style.transform = 'rotate(992deg)';
  wheel.classList.remove('reel-rotation-first');
  overlay.classList.add('win-tab');
  overlay.classList.add('win-mob');
  firstWoman.classList.remove('hide');
  displayPopup(popupFirst);
  wrapper.style.pointerEvents = 'auto';
  overflow.style.overflow = 'hidden';
  setTimeout(function () {
    playBtn.classList.add('pulse-btn');
    playBtn.style.cursor = 'pointer';
    bonusText.style.display = "none";
  }, 1200);
}
function runSecondRotation() {
  wheel.classList.add('reel-rotation-second');
  playBtn.classList.remove('pulse-btn');
  playBtn.style.cursor = 'default';
  overflow.style.overflow = 'hidden';
  wrapper.style.pointerEvents = 'none';
  setTimeout(function () {
    doAfterSecondRotation();
  }, 6000);
  triesCounter++;
}
function doAfterSecondRotation() {
  overlay.classList.add('win-tab');
  overlay.classList.add('win-mob');
  secondWoman.classList.remove('hide');
  displayPopup(popupSecond);
  wrapper.style.pointerEvents = 'auto';
}
popupFirstBtn.addEventListener('click', function () {
  main.classList.remove('blur');
  firstWoman.classList.add('hide');
  chips.forEach(function (el) {
    el.classList.remove('blur');
  });
  overlay.classList.add('opacity-overlay');
  popupFirst.classList.add('hide');
  overflow.style.overflow = 'unset';
  overlay.classList.remove('win-tab');
  overlay.classList.remove('win-mob');
});
function displayPopup(popup) {
  overlay.classList.remove('opacity-overlay');
  popup.classList.remove('hide');
  main.classList.add('blur');
  chips.forEach(function (el) {
    el.classList.add('blur');
  });
  popupChips.forEach(function (el) {
    el.classList.remove('hide');
  });
}
(function () {
  var url = new URL(window.location.href);
  var params = ['l', 'utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content', 'param1', 'param2'];
  var linkParams = ['affid', 'cpaid'];

  // ищем в url redirectUrl в url:
  if (url.searchParams.has('redirectUrl')) {
    var redirectUrl = new URL(url.searchParams.get('redirectUrl'));
    if (redirectUrl.href.match(/\//g).length === 4 && redirectUrl.searchParams.get('l')) {
      //если ссылка в ссылка redirectUrl корректная
      localStorage.setItem('redirectUrl', redirectUrl.href); // указываем точкой входа домен с протоколом из redirectUrl
    }
  }
  /////////

  params.forEach(function (param) {
    if (url.searchParams.has(param)) localStorage.setItem(param, url.searchParams.get(param));
  });
  linkParams.forEach(function (linkParam) {
    if (url.searchParams.has(linkParam)) localStorage.setItem(linkParam, url.searchParams.get(linkParam));
  });
  window.addEventListener('click', function (e) {
    var link,
      parent = e.target.closest('a');
    parent && (e.preventDefault(), localStorage.getItem("redirectUrl") ? link = new URL(localStorage.getItem("redirectUrl")) : (link = new URL(parent.href), affid = localStorage.getItem('affid'), cpaid = localStorage.getItem('cpaid'), affid && cpaid && (link.pathname = '/' + affid + '/' + cpaid)), params.forEach(function (param) {
      url.searchParams.has(param) && link.searchParams.set(param, localStorage.getItem(param));
    }), document.location.href = link);
  });
})();
"use strict";
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzZWNvbmQuanMiXSwibmFtZXMiOlsicGxheUJ0biIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1haW4iLCJjaGlwcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwb3B1cENoaXBzIiwiZmlyc3RXb21hbiIsInNlY29uZFdvbWFuIiwid2hlZWwiLCJvdmVybGF5IiwicG9wdXBGaXJzdCIsInBvcHVwRmlyc3RCdG4iLCJwb3B1cFNlY29uZCIsIm92ZXJmbG93IiwidmlkZW8iLCJ3cmFwcGVyIiwiYm9udXNUZXh0Iiwid2luZG93Iiwib25sb2FkIiwidmlkZW9Tb3VyY2UiLCJlbGVtZW50Iiwic3JjIiwidHlwZSIsImlubmVyV2lkdGgiLCJzb3VyY2UiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJ0cmllc0NvdW50ZXIiLCJhZGRFdmVudExpc3RlbmVyIiwicnVuRmlyc3RSb3RhdGlvbiIsInJ1blNlY29uZFJvdGF0aW9uIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic3R5bGUiLCJjdXJzb3IiLCJwb2ludGVyRXZlbnRzIiwic2V0VGltZW91dCIsImRvQWZ0ZXJGaXJzdFJvdGF0aW9uIiwidHJhbnNmb3JtIiwiZGlzcGxheVBvcHVwIiwiZGlzcGxheSIsImRvQWZ0ZXJTZWNvbmRSb3RhdGlvbiIsImZvckVhY2giLCJlbCIsInBvcHVwIiwidXJsIiwiVVJMIiwibG9jYXRpb24iLCJocmVmIiwicGFyYW1zIiwibGlua1BhcmFtcyIsInNlYXJjaFBhcmFtcyIsImhhcyIsInJlZGlyZWN0VXJsIiwiZ2V0IiwibWF0Y2giLCJsZW5ndGgiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwicGFyYW0iLCJsaW5rUGFyYW0iLCJlIiwibGluayIsInBhcmVudCIsInRhcmdldCIsImNsb3Nlc3QiLCJwcmV2ZW50RGVmYXVsdCIsImdldEl0ZW0iLCJhZmZpZCIsImNwYWlkIiwicGF0aG5hbWUiLCJzZXQiXSwibWFwcGluZ3MiOiI7O0FB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QUFZLENBQUNvQixHQUFHLENBQUNaLEtBQUssRUFBRUYsWUFBWSxDQUFDVSxPQUFPLENBQUNSLEtBQUssQ0FBQyxDQUFDO0lBQzVGLENBQUMsQ0FDSixFQUFFNUQsUUFBUSxDQUFDZ0QsUUFBUSxDQUFDQyxJQUFJLEdBQUdjLElBQUksQ0FBQztFQUNyQyxDQUFDLENBQUM7QUFDTixDQUFDLEdBQUc7QUMxS0oiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuY29uc3QgcGxheUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251c19fbWFpbi13aGVlbC1idG4nKSxcbiAgICAgIG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX21haW4nKSxcbiAgICAgIGNoaXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJvbnVzX19jaGlwJyksXG4gICAgICBwb3B1cENoaXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJvbnVzX19vdmVybGF5LWNoaXAnKSxcbiAgICAgIGZpcnN0V29tYW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX292ZXJsYXktZmlyc3RXb21hbicpLFxuICAgICAgc2Vjb25kV29tYW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX292ZXJsYXktc2Vjb25kV29tYW4nKSxcbiAgICAgIHdoZWVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19tYWluLXdoZWVsLXJlZWwnKSxcbiAgICAgIG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX292ZXJsYXknKSxcbiAgICAgIHBvcHVwRmlyc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX2ZpcnN0V2luJyksXG4gICAgICBwb3B1cEZpcnN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19maXJzdFdpbi1idG4nKSxcbiAgICAgIHBvcHVwU2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19zZWNvbmRXaW4nKSxcbiAgICAgIG92ZXJmbG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLFxuICAgICAgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX21haW4tdmlkZW8tYmcnKSxcbiAgICAgIHdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXMnKVxuXG5cbmNvbnN0IGJvbnVzVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251c19fbWFpbi1idWJibGUnKTtcblxud2luZG93Lm9ubG9hZCA9IHZpZGVvU291cmNlKHZpZGVvLCAnaW1nL3ZpZGVvLm1wNCcsICd2aWRlby9tcDQnKTtcblxuXG5mdW5jdGlvbiB2aWRlb1NvdXJjZShlbGVtZW50LCBzcmMsIHR5cGUpIHtcbiAgICBpZih3aW5kb3cuaW5uZXJXaWR0aCA+IDEwMjQpIHtcbiAgICAgICAgbGV0IHNvdXJjZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpXG4gICAgICAgIHNvdXJjZS5zcmMgPSBzcmNcbiAgICAgICAgc291cmNlLnR5cGUgPSB0eXBlXG4gICAgICAgIHZpZGVvLmFwcGVuZENoaWxkKHNvdXJjZSlcbiAgICB9XG59XG5cbmxldCB0cmllc0NvdW50ZXIgPSAwXG5cbnBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cbiAgICBpZiAodHJpZXNDb3VudGVyID09PSAwKSB7XG4gICAgICAgIHJ1bkZpcnN0Um90YXRpb24oKVxuXG4gICAgfSBlbHNlIHtcbiAgICAgICAgcnVuU2Vjb25kUm90YXRpb24oKVxuICAgIH1cbn0pXG5cbmZ1bmN0aW9uIHJ1bkZpcnN0Um90YXRpb24oKSB7XG4gICAgd2hlZWwuY2xhc3NMaXN0LmFkZCgncmVlbC1yb3RhdGlvbi1maXJzdCcpXG4gICAgcGxheUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdwdWxzZS1idG4nKVxuICAgIHBsYXlCdG4uc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnXG4gICAgd3JhcHBlci5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGRvQWZ0ZXJGaXJzdFJvdGF0aW9uKClcbiAgICB9LCA2MDAwKVxuICAgIHRyaWVzQ291bnRlcisrXG59XG5cbmZ1bmN0aW9uIGRvQWZ0ZXJGaXJzdFJvdGF0aW9uKCkge1xuICAgIHdoZWVsLnN0eWxlLnRyYW5zZm9ybSA9ICdyb3RhdGUoOTkyZGVnKSdcbiAgICB3aGVlbC5jbGFzc0xpc3QucmVtb3ZlKCdyZWVsLXJvdGF0aW9uLWZpcnN0JylcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ3dpbi10YWInKVxuICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZCgnd2luLW1vYicpXG4gICAgZmlyc3RXb21hbi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJylcbiAgICBkaXNwbGF5UG9wdXAocG9wdXBGaXJzdClcbiAgICB3cmFwcGVyLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0bydcbiAgICBvdmVyZmxvdy5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHBsYXlCdG4uY2xhc3NMaXN0LmFkZCgncHVsc2UtYnRuJylcbiAgICAgICAgcGxheUJ0bi5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcidcbiAgICAgICAgYm9udXNUZXh0LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuICAgIH0sIDEyMDApXG59XG5cbmZ1bmN0aW9uIHJ1blNlY29uZFJvdGF0aW9uKCkge1xuICAgIHdoZWVsLmNsYXNzTGlzdC5hZGQoJ3JlZWwtcm90YXRpb24tc2Vjb25kJylcbiAgICBwbGF5QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3B1bHNlLWJ0bicpXG4gICAgcGxheUJ0bi5zdHlsZS5jdXJzb3IgPSAnZGVmYXVsdCdcbiAgICBvdmVyZmxvdy5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nXG4gICAgd3JhcHBlci5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGRvQWZ0ZXJTZWNvbmRSb3RhdGlvbigpXG4gICAgfSwgNjAwMClcbiAgICB0cmllc0NvdW50ZXIrK1xufVxuXG5mdW5jdGlvbiBkb0FmdGVyU2Vjb25kUm90YXRpb24oKSB7XG4gICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCd3aW4tdGFiJylcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ3dpbi1tb2InKVxuICAgIHNlY29uZFdvbWFuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKVxuICAgIGRpc3BsYXlQb3B1cChwb3B1cFNlY29uZClcbiAgICB3cmFwcGVyLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0bydcbn1cblxuXG5wb3B1cEZpcnN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIG1haW4uY2xhc3NMaXN0LnJlbW92ZSgnYmx1cicpXG4gICAgZmlyc3RXb21hbi5jbGFzc0xpc3QuYWRkKCdoaWRlJylcbiAgICBjaGlwcy5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdibHVyJylcbiAgICB9KVxuICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZCgnb3BhY2l0eS1vdmVybGF5JylcbiAgICBwb3B1cEZpcnN0LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKVxuICAgIG92ZXJmbG93LnN0eWxlLm92ZXJmbG93ID0gJ3Vuc2V0J1xuICAgIG92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnd2luLXRhYicpXG4gICAgb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCd3aW4tbW9iJylcbn0pXG5cbmZ1bmN0aW9uIGRpc3BsYXlQb3B1cChwb3B1cCkge1xuICAgIG92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnb3BhY2l0eS1vdmVybGF5JylcbiAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJylcbiAgICBtYWluLmNsYXNzTGlzdC5hZGQoJ2JsdXInKVxuICAgIGNoaXBzLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2JsdXInKVxuICAgIH0pXG4gICAgcG9wdXBDaGlwcy5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJylcbiAgICB9KVxufVxuXG4oZnVuY3Rpb24gKCkge1xuICAgIGxldCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxuXG4gICAgY29uc3QgcGFyYW1zID0gW1xuICAgICAgICAnbCcsXG4gICAgICAgICd1dG1fc291cmNlJyxcbiAgICAgICAgJ3V0bV9tZWRpdW0nLFxuICAgICAgICAndXRtX2NhbXBhaWduJyxcbiAgICAgICAgJ3V0bV90ZXJtJyxcbiAgICAgICAgJ3V0bV9jb250ZW50JyxcbiAgICAgICAgJ3BhcmFtMScsXG4gICAgICAgICdwYXJhbTInXG4gICAgXVxuXG4gICAgY29uc3QgbGlua1BhcmFtcyA9IFtcbiAgICAgICAgJ2FmZmlkJyxcbiAgICAgICAgJ2NwYWlkJ1xuICAgIF1cblxuICAgIC8vINC40YnQtdC8INCyIHVybCByZWRpcmVjdFVybCDQsiB1cmw6XG4gICAgaWYgKHVybC5zZWFyY2hQYXJhbXMuaGFzKCdyZWRpcmVjdFVybCcpKSB7XG4gICAgICAgIHZhciByZWRpcmVjdFVybCA9IG5ldyBVUkwodXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3JlZGlyZWN0VXJsJykpO1xuICAgICAgICBpZiAocmVkaXJlY3RVcmwuaHJlZi5tYXRjaCgvXFwvL2cpLmxlbmd0aCA9PT0gNCAmJiByZWRpcmVjdFVybC5zZWFyY2hQYXJhbXMuZ2V0KCdsJykpIHsgLy/QtdGB0LvQuCDRgdGB0YvQu9C60LAg0LIg0YHRgdGL0LvQutCwIHJlZGlyZWN0VXJsINC60L7RgNGA0LXQutGC0L3QsNGPXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmVkaXJlY3RVcmwnLCByZWRpcmVjdFVybC5ocmVmKTsgLy8g0YPQutCw0LfRi9Cy0LDQtdC8INGC0L7Rh9C60L7QuSDQstGF0L7QtNCwINC00L7QvNC10L0g0YEg0L/RgNC+0YLQvtC60L7Qu9C+0Lwg0LjQtyByZWRpcmVjdFVybFxuICAgICAgICB9XG4gICAgfVxuICAgIC8vLy8vLy8vL1xuXG4gICAgcGFyYW1zLmZvckVhY2goKHBhcmFtKSA9PiB7XG4gICAgICAgIGlmICh1cmwuc2VhcmNoUGFyYW1zLmhhcyhwYXJhbSkpIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHBhcmFtLCB1cmwuc2VhcmNoUGFyYW1zLmdldChwYXJhbSkpXG4gICAgfSlcblxuICAgIGxpbmtQYXJhbXMuZm9yRWFjaCgobGlua1BhcmFtKSA9PiB7XG4gICAgICAgIGlmICh1cmwuc2VhcmNoUGFyYW1zLmhhcyhsaW5rUGFyYW0pKSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShsaW5rUGFyYW0sIHVybC5zZWFyY2hQYXJhbXMuZ2V0KGxpbmtQYXJhbSkpXG4gICAgfSlcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBsaW5rLCBwYXJlbnQgPSBlLnRhcmdldC5jbG9zZXN0KCdhJylcbiAgICAgICAgcGFyZW50ICYmIChcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKSxcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicmVkaXJlY3RVcmxcIikgP1xuICAgICAgICAgICAgbGluayA9IG5ldyBVUkwobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJyZWRpcmVjdFVybFwiKSlcbiAgICAgICAgICAgIDogKFxuICAgICAgICAgICAgICAgIGxpbmsgPSBuZXcgVVJMKHBhcmVudC5ocmVmKSxcbiAgICAgICAgICAgICAgICBhZmZpZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhZmZpZCcpLFxuICAgICAgICAgICAgICAgIGNwYWlkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NwYWlkJyksXG4gICAgICAgICAgICAgICAgYWZmaWQgJiYgY3BhaWQgJiYgKGxpbmsucGF0aG5hbWUgPSAnLycgKyBhZmZpZCArICcvJyArIGNwYWlkKVxuICAgICAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgIHBhcmFtcy5mb3JFYWNoKChwYXJhbSkgPT4ge1xuICAgICAgICAgICAgICAgIHVybC5zZWFyY2hQYXJhbXMuaGFzKHBhcmFtKSAmJiBsaW5rLnNlYXJjaFBhcmFtcy5zZXQocGFyYW0sIGxvY2FsU3RvcmFnZS5nZXRJdGVtKHBhcmFtKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgKSwgZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IGxpbmspXG4gICAgfSlcbn0pKCkiLCIiXX0=
